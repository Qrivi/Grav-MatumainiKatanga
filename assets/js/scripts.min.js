function _readOnlyError(name) { throw new Error("\"" + name + "\" is read-only"); }

// Sticky header if necessary
var header = document.querySelector('body > header');
var scrollPos = 0;
window.addEventListener('scroll', function () {
    window.scrollY < 300 ? header.classList.remove('invert') : (header.classList.add('invert'), document.body.getBoundingClientRect().top < scrollPos ? header.classList.add('hidden') : header.classList.remove('hidden')), scrollPos = document.body.getBoundingClientRect().top;
}), Array.from(document.querySelectorAll('a[href*="#"]:not([href="#"])')).forEach(function (link) {
    return link.addEventListener('click', function (event) {
        event.preventDefault(), header.classList.add('hidden'), document.querySelector(link.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    }, false);
});
// Activity filtering
var allPosts = document.querySelectorAll("ul.postlist li");
var morePosts = document.querySelector("#activiteiten a.more-posts");
var filterInput = document.querySelector("#filter");
var filterDelay = 100;
var filterDebounce = null;
var hasFiltered = false;
var loadedPosts = 6;
if (morePosts && morePosts.addEventListener('click', function () {
    resetPosts(loadedPosts + 3);
}), filterInput && filterInput.addEventListener('input', function () {
    filterDebounce && window.clearTimeout(filterDebounce), hasFiltered = true, filterDebounce = window.setTimeout(filterPosts, 1000);
}), window.location.search.includes('filter=')) filterInput.value = window.location.search.match(/filter=(.*)/)[1].replace(/\+/g, ' '), filterPosts(); else if (window.location.search.includes('activiteiten=')) {
    var amount = parseInt(window.location.search.match(/activiteiten=(.*)/)[1]);
    isNaN(amount) && (amount = (_readOnlyError("amount"), 6)), resetPosts(amount);
}

function resetPosts(amount) {
    if (loadedPosts = amount, morePosts.style.visibility = 'visible', Array.from(allPosts).forEach(function (post, index) {
        index < amount ? showPost(post) : post.classList.add('hidden');
    }), 'URLSearchParams' in window) {
        var searchParams = new URLSearchParams(window.location.search);
        searchParams.set('activiteiten', loadedPosts), history.pushState(null, '', window.location.pathname + '?' + searchParams.toString());
    }
}

function filterPosts() {
    if (morePosts && !filterInput.value.length) return resetPosts(6);

    if (morePosts && (morePosts.style.visibility = 'hidden'), Array.from(allPosts).forEach(function (post) {
        post.textContent.toUpperCase().includes(filterInput.value.toUpperCase()) ? showPost(post) : hidePost(post);
    }), 'URLSearchParams' in window && hasFiltered) {
        var searchParams = new URLSearchParams(window.location.search);
        searchParams.set('filter', filterInput.value), history.pushState(null, '', window.location.pathname + '?' + searchParams.toString());
    }
}

function hidePost(post) {
    !post.classList.contains('hidden') && (post.classList.add('hiding'), window.setTimeout(function () {
        post.classList.add('hidden');
    }, 800));
}

function showPost(post) {
    post.classList.contains('hidden') && (post.classList.remove('hidden'), post.classList.add('hiding'), window.setTimeout(function () {
        post.classList.remove('hiding');
    }, 10));
}
